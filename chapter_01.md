## 1 章

### オブジェクト指向なデザイン

世界は手続き的です。時間は未来に向かって流れ、出来事がひとつまたひとつと生起しては消えていきます。
みなさんの朝の手続きは、起床して、歯を磨き、コーヒーを淹れて、服を着て、仕事に取り掛かるといったところでしょうか。
これら行為は手続き型のソフトウェアでモデリングすることができます。みなさんはそれぞれの行為の順番を知っていて、
その行為が何をするのかコードに書くことができますし、自分の意図でひとつひとつの行為を並べることもできるからです。

世界はオブジェクト指向的でもあります。みなさんが関わるオブジェクトは、配偶者（"spouse"）や猫（"cat"）、
古い自動車やガレージの中のバイクのパーツの山だったり、あるいはドキドキする心臓や健康のためのエクササイズ
のプランかもしれません。これらオブジェクトにはそれぞれ固有の振る舞いがあります。オブジェクトどうしのやり取り
があらかじめ決まっている場合もありますが、あなたの配偶者が思いがけず猫を踏んでしまったことが、
みんなの心臓をドキドキさせたり、あなたにエクササイズのプランを再評価させるような事態だって起こりえます。

オブジェクトの世界では、新たな振る舞いの組み合わせは自然に現れます。`spouse_steps_on_cat` という
手続きを明示的にコーディングする必要はありません。みなさんがすべきことは、歩く配偶者オブジェクトと
踏まれるのが嫌いな猫オブジェクトを作ることだけです。そして、このふたつのオブジェクトをひとつの部屋に
押し込むと思いがけない振る舞いの組み合わせが出現するのです。

この本は、オブジェクト指向なソフトウェアのデザインについて書かれています。
そして、世界はオブジェクトどうしの自発的なやり取りの連続からできているという視点で書かれています。
オブジェクト指向なデザイン（OOD: Object-oriented design）は、みなさんの世界についての認識をシフトさせます。
あらかじめ定義された手続きの集まりとしての世界から、オブジェクト間でやり取りされるメッセージの連続として
の世界へのシフトです。OOD で失敗するのはコーディング技術が不足しているからだと思われそうですが、
実際は世界についての認識が間違っているから失敗するのです。オブジェクト指向なデザインを学ぶには、
まずオブジェクトの世界にどっぷり浸る必要があります。オブジェクト指向な世界観を一度体得してしまえば、
あとはおのずとついてきます。

この本では、浸礼のプロセスを通じてみなさんをオブジェクト指向なデザインへと案内していきます。
本章は、OODについての全般的な議論から出発します。まずデザイン一般について議論したのち、
いつデザインすべきか、それをどう判断すべきかについてお話しします。
そして最後に、オブジェクト指向プログラミングについて概観し、本書で使われる用語を定義します。

#### デザインのススメ

あるソフトウェアが作られるのには何らかの理由があります。トリビアルなゲームであろうと放射線治療の
プログラムであろうと、ターゲットのアプリケーションにすべてが凝縮されています。動くソフトウェア
を生み出すのにもっとも費用対効果の高い方法が苦痛に満ちたプログラミングならば、プログラマーはただ黙って
耐え忍ぶか別の仕事を探すことになるでしょう。

幸いにも、みなさんは喜びと生産性、いずれかの二者択一に迫られることはありません。コードを書くことが喜びと
なるようなプログラミングテクニックと費用対効果の高いソフトウェア開発を実現するテクニックとは
オーバーラップします。オブジェクト指向デザインのテクニックは、仕事への意欲とプログラミングにまつわる技術上の
ディレンマを解決します。このテクニックは、書くことが楽しくなるコードによって費用対効果の高いソフトウェアを
生み出します。


##### デザインが解決する問題

あたらしいアプリケーションを書くとしましょう。そのアプリケーションはすべての要件を完全に、
そして正確に実装しているとします。そしてもうひとつこう仮定します。一度書かれたアプリケーション
は決して変更されることはない、と。

このような状況ではデザインは問題になりません。サーカスのパフォーマが摩擦も重力もない世界で
皿回しをするように、プログラムしたアプリケーションが動き出すとあなたはそこから離れ、それが永遠に
動き続ける様子を眺めるのです。どんな不安定に見えても、コードの皿は回り続け、
ふらふら旋回しながらも決して落ちることはありません。

何も変わらない限りは。

残念ながら何かが変化します。いつもそうです。カスタマは最初から本当に自分が欲しいものが何か分かりませんし、
本当に伝えたいことは言えません。みなさんはカスタマのニーズを理解しておらず、どうすればより良くなるのかを
その都度学んでいます。どこから見てもパーフェクトなアプリケーションであっても安泰ということはありません。
アプリケーションが大成功すると、みんなそれにもっと期待するようになります。そうなると変更はさけられません。
これはいたるところで言えることであり、普遍的で不可避なことなのです。

変化する要件は摩擦と重力に相当します。摩擦と重力は慎重に錬成された計画に突如予期せぬプレッシャ
をかけます。デザインが重要なのは変更の必要性からです。

変更が容易なアプリケーションは書くのが楽しいですし、大きくすることが喜びとなります。柔軟で適応性が高いのです。
変更に抵抗するアプリケーションはまったく逆です。どんな変更も高くつき、変更すればつぎのコストを生みます。
変更しにくいアプリケーションのほとんどの場合、仕事していても楽しくありません。そのうちでも最悪なものは、
だんだん恐怖映画じみてきて、そこで不運なプログラマであるみなさん、は床に焼き物の皿が落ちて砕ける音を防ごうと
回転する皿の間を狂ったように走り回りまわるのです。

##### 変更はなぜ難しいのか？

> under development

#### まとめ

充分長い時間動いているアプリケーション、つまり成功しているアプリケーションが遭遇する最大の
問題は変更への対処です。変更に対して手際よく対処できるようコードをアレンジすることはデザインの仕事です。
デザインでいちばんわかりやすい要素は基本原則とパターンですが、基本原則をいくら正しく適用しても、
パターンをいくら適切に使っても変更しやすいアプリケーションの開発を保証してくれたりはしません。

メトリクスは、アプリケーションがどの程度オブジェクト指向デザインの基本原則をフォローしているのか
教えてくれます。メトリクスの悪いアプリケーションは将来何らかの問題に出くわすでしょう。
しかし、メトリクスが良いからといって楽観はできません。問題を起こすようなデザインのメトリクスが良い
場合もあるでしょうし、メトリクスが良くても変更のコストは高いままかもしれません。

良いデザインの秘訣は、デザインの理論をきちんと習得すること、そして習得した理論を適切に、
つまり正しいタイミングで正しい量を適用することです。デザインの良し悪しは理論を実践に翻訳する
みなさんの力量にかかっています。

理論と実践の違いは何でしょう？

理論には何もありません。もし理論が実践ならば、オブジェクト指向デザインのルールを習得し、ひたすらルールを
適用していけば、その日からパーフェクトなコードを書くことができるでしょう。そこでみなさんの仕事は完了です。

理論がいくらそれを正しいと主張したところで、その主張をよりよく知っているのは実践のほうです。
理論とはちがい、実践は自らの手を汚します。煉瓦を積み上げ、橋を架け、コードを書くのは実践です。
実践は、変化と混乱と不確実に満ちた現実の世界に生きています。いくつもの選択肢を秤にかけ、ときに苦々しくありながらも
より邪悪でないほうを選択しなければならないような状況に遭遇します。身をかわし、隠れ、借りた金で返済したり
するのが実践です。いまある資源でベストを尽くし身過ぎ世過ぎすることが実践です。

理論は有益であり必要というのが本章の主張でした。ですがもう理論は十分です。実践に移りましょう。


